SELECT pays,
       SUM(dispo_alim_kcal_p_j) 
  FROM dispo_alim
 WHERE année = "2017"
 GROUP BY pays
 ORDER BY SUM(dispo_alim_kcal_p_j) DESC
 LIMIT 10;-- Les 10 pays ayant le plus haut ratio disponibilité alimentaire/habitant en termes de kcal par habitant

SELECT pays,
       ROUND(SUM(dispo_prot) ) 
  FROM dispo_alim
 WHERE année = "2017"
 GROUP BY pays
 ORDER BY SUM(dispo_prot) DESC;-- Pour chaque année disponible, les 10 pays ayant le plus faible ratio disponibilité alimentaire/habitant en termes de protéines (en kg) par habitant

SELECT *
  FROM (
           SELECT pays,
                  année,
                  ROUND(SUM(dispo_prot) ) 
             FROM dispo_alim
            WHERE année = "2012"
            GROUP BY pays
            ORDER BY SUM(dispo_prot) 
            LIMIT 10
       )
UNION ALL
SELECT *
  FROM (
           SELECT pays,
                  année,
                  ROUND(SUM(dispo_prot) ) 
             FROM dispo_alim
            WHERE année = "2013"
            GROUP BY pays
            ORDER BY SUM(dispo_prot) 
            LIMIT 10
       )
UNION ALL
SELECT *
  FROM (
           SELECT pays,
                  année,
                  ROUND(SUM(dispo_prot) ) 
             FROM dispo_alim
            WHERE année = "2014"
            GROUP BY pays
            ORDER BY SUM(dispo_prot) 
            LIMIT 10
       )
UNION ALL
SELECT *
  FROM (
           SELECT pays,
                  année,
                  ROUND(SUM(dispo_prot) ) 
             FROM dispo_alim
            WHERE année = "2015"
            GROUP BY pays
            ORDER BY SUM(dispo_prot) 
            LIMIT 10
       )
UNION ALL
SELECT *
  FROM (
           SELECT pays,
                  année,
                  ROUND(SUM(dispo_prot) ) 
             FROM dispo_alim
            WHERE année = "2016"
            GROUP BY pays
            ORDER BY SUM(dispo_prot) 
            LIMIT 10
       )
UNION ALL
SELECT *
  FROM (
           SELECT pays,
                  année,
                  ROUND(SUM(dispo_prot) ) 
             FROM dispo_alim
            WHERE année = "2017"
            GROUP BY pays
            ORDER BY SUM(dispo_prot) 
            LIMIT 10
       );-- La quantité totale (en kg) de produits perdus par pays et par année

SELECT pays,
       année,
       pertes * 1000000
  FROM equilibre_prod;-- Les 10 pays pour lesquels la proportion de personnes sous-alimentées est la plus forte

SELECT p.pays,
       année,
       s.nb_personnes * 100 / p.population
  FROM population AS p,
       sous_nutrition AS s
 WHERE p.code_pays = s.code_pays AND 
       p.année = s.année AND
       P.année = "2017"
 ORDER BY s.nb_personnes * 100 / p.population DESC
 LIMIT 100;-- Les 10 pays pour lesquels la proportion de personnes sous-alimentées est la plus forte
 
SELECT produit,
       SUM(dispo_int),
       SUM(autres_utilisations),
       SUM(autres_utilisations)*100/SUM(dispo_int) as "ratio(en%)"
  FROM equilibre_prod
 GROUP BY produit
 ORDER BY "ratio(en%)" DESC;-- Les 10 produits pour lesquels le ratio Autres utilisations/Disponibilité intérieure est le plus élevé.
   
